<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640">

    <link rel="stylesheet" href="stylesheets/core.css" media="screen">
    <link rel="stylesheet" href="stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">

    <script type="text/javascript" src="javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>Monitor-db2-with-nagios by angoca</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/angoca/monitor-db2-with-nagios">View on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>Monitor-db2-with-nagios</h1>
            <h2>Set of plugins / scripts to monitor DB2 from Nagios.</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/angoca/monitor-db2-with-nagios/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/angoca/monitor-db2-with-nagios/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>


      <span class="banner-fix"></span>


      <section id="main_content">
        <h1>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>Description</h1>

<p>This project aims to provide a set of open source tools to monitor DB2. The monitoring is limited to control that a value is between a range. The output of the scripts, allows you to create graphs and see the behavior of the monitored elements.</p>

<h2>
<a name="open-source" class="anchor" href="#open-source"><span class="octicon octicon-link"></span></a>Open source</h2>

<p>There are many tools or programs in the market that allow you to monitor DB2. There are a few that are really good, and you can understand what is happening inside DB2, and then you can take the best decisions.</p>

<p>However, these software is not free, and something the licenses are expensive. If you took the way to use DB2 Express-C, it is because your current plan is not to pay for the database software (probably you are testing a new feature, you have a small set of data, etc.), and in the same way you are not going to pay for the monitoring software for that database.</p>

<p>With this is mind, this is the reason this project is open source, to allow people to have a basic monitoring for their DB2 databases.</p>

<h2>
<a name="bash-script" class="anchor" href="#bash-script"><span class="octicon octicon-link"></span></a>Bash script</h2>

<p>The decision to create the scripts in shell was to not depend in a compiler, such as Java or C, or interpreters like Perl or Python. Bash is independent, and ready to use if bash is available.</p>

<p>Why bash and not korn? well, it was because it is included in all Linux and it is becoming important. It is not probably the best, but many people know how to use it.</p>

<h2>
<a name="independent-scripts-no-architecture" class="anchor" href="#independent-scripts-no-architecture"><span class="octicon octicon-link"></span></a>Independent scripts (no architecture)</h2>

<p>This set of script was born as an extension ad improve to a set of scripts hosted in dbatodba. It took the same basis, and after that, we see that each script could be modified independently. This provide a lot of flexibility, because a modification does not impact the other scripts.</p>

<p>The lack of architecture could be an issue. But the initial aim was to provide a simple set of scripts to monitor DB2.</p>

<p>The similarity of the scripts is guided by a template that already has the basic structure for all scripts. This template has a specific space for the specific part to be monitored, with many validations done before. You will see that all scripts are based on the template.</p>

<p>We are currently thinking to create a new project / branch to have an architecture. It will be very different from this project, because the scripts will share code, but it will reduce the impact of connection per script, with an asynchronous check. It could probably use jNRPE, and the aim is to keep an active connection to the database, in order to reduce the connection establishment for each check.</p>

<h2>
<a name="extensibility" class="anchor" href="#extensibility"><span class="octicon octicon-link"></span></a>Extensibility</h2>

<p>You can modify any script to your own requirements, you just have to edit the file and that is all.</p>

<p>You can also create you own scripts, based on template, just by copying the template.sh file. The benefict of writing a new script based on template, is that your script will be Nagios complaint.</p>

<h2>
<a name="support" class="anchor" href="#support"><span class="octicon octicon-link"></span></a>Support</h2>

<p>This is an open source project, and no support is provided. However, you can write an issue here, and we will try to help you.</p>

<p>Also, if you create your own set of plugins or you corrected the existing ones, share them with us. The community will see the benefit of this collaboration.</p>

<h1>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>This is the procedure to install this set of scripts to monitor DB2.</p>

<h2>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h2>

<p>The requirements are:</p>

<ul>
<li>DB2 (These scripts have been tested in b9.7 and v10.5, and many scripts could work in v9.5)</li>
<li>Nagios (In v3 has been tested)</li>
<li>Linux / Unix with Bash</li>
<li>Optional: Check_MK</li>
</ul><h2>
<a name="retrieving-scripts" class="anchor" href="#retrieving-scripts"><span class="octicon octicon-link"></span></a>Retrieving scripts</h2>

<p>The only way to get the binaries is via this forge.</p>

<ul>
<li>You can download a generated zip containing all files.</li>
<li>Cloning the git repository.</li>
</ul><p>The first option allows you have a snapshot copy of all scripts. This is useful if you cannot access GitHub from the Nagios or DB2 server, and you have to download to an stage area (i.e. your own PC) and then copy to the target server. With this option you have to repeat the process in order to get the new versions.</p>

<p>The second option is the easiest and it is recommended. As scripts are sources, the best is to provide a mechanism designed to manage source files. When you clon this repository, you will get the most recent version of all scripts. If you want to update to a newest version, you just have to pull the new sources <code>git pull</code>. If you modified the scripts for your own requirements, you can create a branch for edit purposes, and other for the original scripts.</p>

<h2>
<a name="configuration" class="anchor" href="#configuration"><span class="octicon octicon-link"></span></a>Configuration</h2>

<p>Each script has to be configured individually. Each script is autonomous, and they do not require configuration files, of similar thing.</p>

<p>In order to add this set of scripts to your Nagios installation, you can open each script and see the documentation. Each script contain examples of the parameters to put in the configuration file.</p>

<p>The default configuration probably will not work with your requirements, and for this reason you have to tune the warning and critical parameters, in order to not receive "false positives" (You do not want to be waked up at midnight for an alarm that does not really exists.)</p>

<h1>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h1>

<p>Most of the scripts need the instance directory where they are going to be executed.</p>

<p>Let's suppose we are going to use <code>check_instance_up</code>. You will need to pass the directory instance with the parameter <code>-i</code>. The directory instance is the home directory of the user that executes the instance.</p>

<p>You can get the instances of a server by running <code>db2greg -dump</code></p>

<pre><code>/opt/ibm/db2/V9.7/bin/db2greg -dump
</code></pre>

<p>The output is similar to</p>

<pre><code>S,DB2,9.7.0.7,/opt/ibm/db2/V9.7,,,7,0,,1361790210,0
V,DB2GPRF,DB2SYSTEM,DB2META-10,/opt/ibm/db2/V9.7,
V,DB2GPRF,DB2ADMINSERVER,dasusr1,/opt/ibm/db2/V9.7,
I,DB2,9.7.0.7,db2inst1,/home/db2inst1,,1,0,/opt/ibm/db2/V9.7,,
</code></pre>

<p>The lines starting by <code>I</code> indicate an instance in the server.
You can get the home directory of a given user by</p>

<pre><code>echo ~db2inst1
</code></pre>

<p>One you have the home directory</p>

<pre><code>./check_instance_up -i /home/db2inst1
</code></pre>

<p>If something is wrong, you will get the error message</p>

<pre><code>./check_instance_up
Usage: check_instance_up { -i instanceHomeDirectory # -h # -V } [ -v ]
Note: The test was not executed.|
|
</code></pre>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/angoca">angoca</a> can be found on <a href="https://github.com/angoca/monitor-db2-with-nagios">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="http://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>

    
  </body>
</html>
